(window.webpackJsonp=window.webpackJsonp||[]).push([[76,37],{255:function(e,t,r){"use strict";r.r(t),r.d(t,"searchMobile",(function(){return o}));var a=r(49),s=r.n(a),i=r(57),n=r(66);var o=new class{constructor(){this.inited=!1}init(){this.inited||(this.searchOverlayOpen=!1,this.quickSearchText="",this.latestSearchResultHTML=null,this.searchCallReady=!1,this.prevHeight=0,this.initDOMElements(),this.initBindings(),this.inited=!0)}initDOMElements(){this.searchForm=document.querySelector("[data-search-form-mobile]"),this.searchField=document.querySelector("[data-search-form-mobile] input"),this.searchResult=document.querySelector("[data-search-results-mobile]"),this.subNav=document.querySelector("nav.primary"),this.searchCloseBtn=document.querySelector("header svg.hamburger.right"),this.searchBackBtn=document.querySelector("nav.primary .search a.close-sub-nav")}initBindings(){this.searchResult&&this.searchResult.addEventListener("transitionend",this.searchSuccess.bind(this)),this.searchSubmit&&this.searchSubmit.addEventListener("click",e=>{e.preventDefault(),this.handleSearchInputChange(e)}),this.searchForm&&(this.searchForm.addEventListener("submit",this.preventSubmit),this.searchField.addEventListener("focus",()=>{this.searchField.tabIndex="-1",window.scrollTo(0,0),document.body.scrollTop=0,setTimeout(()=>{this.subNav.classList.add("searching")},100)})),this.searchField&&this.searchField.addEventListener("input",s()(e=>{this.handleSearchInputChange(e)},200)),this.searchCloseBtn&&this.searchCloseBtn.addEventListener("click",s()(this.resetSearch.bind(this),300,{leading:!0,trailing:!1})),this.searchBackBtn&&this.searchBackBtn.addEventListener("click",s()(this.resetSearch.bind(this),300,{leading:!0,trailing:!1}))}handleSearchInputChange(e){var t=e.target.value;if(t&&t.length>=3&&this.searchResult&&this.searchForm){this.searchForm.classList.add("loading"),this.searchResult.classList.add("hide"),this.searchCallReady=!1;var r=document.querySelector("[data-search-index]"),a=null;r&&(a=r.getAttribute("data-search-index")),i.a.search(e.target.value,a).then(e=>{if(e&&e.Categories){var t=this.calcSearchResultHeight(e);this.latestSearchResultHTML=n.a.render("search-result",e),this.searchForm.classList.remove("loading"),this.searchCallReady=!0,this.searchSuccess(),this.prevHeight=t}})}else this.latestSearchResultHTML="",this.searchResult.classList.add("hide")}preventSubmit(e){e&&e.preventDefault()}searchSuccess(e){e&&e.target===this.searchResult&&e.stopPropagation(),this.searchCallReady&&(this.searchResult.innerHTML=this.latestSearchResultHTML,this.searchResult.classList.remove("hide"))}calcSearchResultHeight(e){var t=e.Categories.length;return 50*e.Categories.reduce((e,t)=>e+t.Results.length,0)+35*t+10*(t-1)+32}resetSearch(){this.searchOverlayOpen=!1,this.searchField.value="",this.searchField.tabIndex="",this.latestSearchResultHTML="",this.searchResult.classList.add("hide"),this.subNav.classList.remove("searching")}}},57:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var a=r(64),s=r(63),i=document.body.getAttribute("data-lang")?document.body.getAttribute("data-lang"):"en-US",n=["en-us","en-gb","gb","us","lr"];var o=new class{constructor(){this.baseUrl=""}getModelPage(e){return a.a.request("".concat(this.baseUrl).concat(e,"?xhr=1"),"get",{},!1,!1).then(e=>e).catch(e=>{(e||{}).message&&s.generalError.showError(e.message)})}specs(e){return a.a.request("".concat(this.baseUrl,"/Sitefinity/Public/Services/Car/CarService.svc/").concat(i,"/Car/").concat(e)).then(e=>((e||{}).data,e.data)).catch(e=>{console.log("%c %s %s %s ","color: yellow; background-color: black;","--","Specs service error: ".concat(e),"--")})}getModels(){return a.a.request("".concat(this.baseUrl,"/api/v1/cars?scope={1FA6BDF3-332D-4D65-8D12-175CDB51DF75}")).then(e=>((e||{}).data,e.data)).catch(e=>{(e||{}).message&&s.generalError.showError(e.message)})}enquireForm(e){var t={};return a.a.request("".concat(this.baseUrl,"/api/enquire/add"),"post",e).then(e=>{if((e||{}).data,400===e.status&&e.data.ModelState){var r=e.data.ModelState;Object.keys(r).forEach(e=>t[e.split(".")[1]]=r[e])}else t=e.data;return t}).catch(e=>{(e||{}).message&&s.generalError.showError(e.message)})}enquireFormV2(e){var t={};return a.a.request("".concat(this.baseUrl,"/api/v2/enquire/add"),"post",e).then(e=>{if((e||{}).data,400===e.status&&e.data.ModelState){var r=e.data.ModelState;Object.keys(r).forEach(e=>t[e.split(".")[1]]=r[e])}else t=e.data;return t}).catch(e=>{(e||{}).message&&s.generalError.showError(e.message)})}enquireCampaignForm(e){var t={};return a.a.request("".concat(this.baseUrl,"/api/campaignenquire/add"),"post",e).then(e=>{if((e||{}).data,400===e.status&&e.data.ModelState){var r=e.data.ModelState;Object.keys(r).forEach(e=>t[e.split(".")[1]]=r[e])}else t=e.data;return t}).catch(e=>{(e||{}).message&&s.generalError.showError(e.message)})}customEnquireForm(e,t){var r=t||"/api/enquire/add",i={};return a.a.request("".concat(r),"post",e).then(e=>{if((e||{}).data,400===e.status&&e.data.ModelState){var t=e.data.ModelState;Object.keys(t).forEach(e=>i[e.split(".")[1]]=t[e])}else i=e.data;return i}).catch(e=>{(e||{}).message&&s.generalError.showError(e.message)})}addToCart(e){return a.a.request("".concat("/api/basket/addtocart/"),"post",e).then(e=>e).catch(e=>{(e||{}).message&&s.generalError.showError(e.message)})}getCart(){return a.a.request("".concat("/api/basket/getcart")).then(e=>e).catch(e=>{(e||{}).message&&s.generalError.showError(e.message)})}getDealer(){return a.a.request("".concat(this.baseUrl,"/api/v1/dealers/bycountry?cultureName=").concat(i)).then(e=>((e||{}).data,e.data)).catch(e=>{(e||{}).message&&s.generalError.showError(e.message)})}search(e,t){var r={};return a.a.request("".concat(this.baseUrl,"/Sitefinity/Public/Services/CustomSearch/CustomSearch.svc/").concat(t,"/").concat(i,"/SearchResults/?term=").concat(e,"&takeInGroup=3")).then(e=>((e||{}).data&&(r=e.data),(r||{}).Categories&&0===r.Categories.length&&(r={Categories:[{Name:"No result found",Results:[],TotalCount:0}]}),r)).catch(e=>{(e||{}).message&&s.generalError.showError(e.message)})}getCarCarouselData(e){var t={};return a.a.request("".concat(this.baseUrl,"/Sitefinity/Public/Services/Car/CarService.svc/").concat(i,"/CarPresets/").concat(e)).then(e=>((e||{}).data&&(t=e.data),t)).catch(e=>{console.log("%c %s %s %s ","color: yellow; background-color: black;","--","Car service error: ".concat(e),"--")})}findDealers(e,t){var r={};return a.a.request("".concat(this.baseUrl,"/api/enquire/findDealers?latitude=").concat(e,"&longitude=").concat(t,"&cultureName=").concat(i,"&take=150")).then(e=>{if((e||{}).data){var t=e.data,a="DistanceMetres";~n.indexOf(i.toLowerCase())&&(a="DistanceMiles"),r=t.map(e=>({distance:(e||{})[a].toFixed(1)||"-",name:(e||{}).Name||"-",address:"".concat(((e||{}).Address||{}).Street,", ").concat(((e||{}).Address||{}).City,", ").concat(((e||{}).Address||{}).Zip)||"-",lat:((e||{}).Address||{}).Latitude||"-",lon:((e||{}).Address||{}).Longitude||"-",phone:(e||{}).PhoneNumber||"-",website:(e||{}).WebsiteURL||"-",dealer:(e||{}).DealerCode}))}return r}).catch(e=>{(e||{}).message&&s.generalError.showError(e.message)})}findDealers2(e,t){var r={};return a.a.request("".concat(this.baseUrl,"/api/v1/dealers?latitude=").concat(e,"&longitude=").concat(t,"&cultureName=").concat(i,"&take=26")).then(e=>{if((e||{}).data){var t=e.data;r=t.map(e=>this.transformDealerData(e))}return r}).catch(e=>{(e||{}).message&&s.generalError.showError(e.message)})}transformDealerData(e){var t=(e||{}).OpeningHours||[];return t.length&&t.push(t.shift()),{DistanceMetres:((e||{}).DistanceMetres||0).toFixed(1)||"",DistanceMiles:((e||{}).DistanceMiles||0).toFixed(1)||"",name:(e||{}).Name||"",address:"".concat(((e||{}).Address||{}).Street||"",", ").concat(((e||{}).Address||{}).City||"",", ").concat(((e||{}).Address||{}).Zip||"")||"",lat:((e||{}).Address||{}).Latitude||"",lon:((e||{}).Address||{}).Longitude||"",phone:(e||{}).PhoneNumber||"",website:(e||{}).WebsiteUrl||null,dealerPageUrl:(e||{}).DealerPageUrl||null,dealer:(e||{}).DealerCode,typeName:((e||{}).DealerType||{}).Name,OpeningHours:t,campaignId:((e||{}).CampaignId||{}).CampaignId,countryCode:((e||{}).Address||{}).CountryCode}}transformDealerDataFromConfig(e){var t=(e||{}).openingHours||[];return t.length&&t.push(t.shift()),{DistanceMetres:((e||{}).distanceMetres||0).toFixed(1)||"",DistanceMiles:((e||{}).distanceMiles||0).toFixed(1)||"",name:(e||{}).name||"",address:"".concat(((e||{}).address||{}).street||"",", ").concat(((e||{}).address||{}).city||"",", ").concat(((e||{}).address||{}).zip||"")||"",lat:((e||{}).address||{}).latitude||"",lon:((e||{}).address||{}).longitude||"",phone:(e||{}).phoneNumber||"",website:(e||{}).websiteUrl||null,dealerPageUrl:(e||{}).dealerPageUrl||null,dealer:(e||{}).dealerCode,typeName:((e||{}).dealerType||{}).Name,OpeningHours:t,campaignId:(e||{}).campaignId,countryCode:((e||{}).address||{}).countryCode}}}},63:function(e,t,r){"use strict";r.r(t),r.d(t,"generalError",(function(){return a}));var a=new class{init(){this.AUTO_CLOSE=!0,this.CLOSE_TIMEOUT=5e3,this.onClickBind=this.onClick.bind(this),this.initDOMElements(),this.initBindings()}destroy(){this.errorCloseButton&&this.errorCloseButton.removeEventListener("click",this.onClickBind)}initDOMElements(){this.errorContainer=document.querySelector("[data-general-error]"),this.errorMessage=document.querySelector("[data-general-error-message]"),this.errorCloseButton=document.querySelector("[data-general-error-close]")}initBindings(){this.errorCloseButton&&this.errorCloseButton.addEventListener("click",this.onClickBind)}onClick(e){e.preventDefault(),this.closeError()}showError(e){this.errorContainer&&this.errorMessage&&(this.errorMessage.innerHTML=e,this.errorContainer.classList.add("general-error--open"),this.AUTO_CLOSE&&setTimeout(()=>this.closeError(),this.CLOSE_TIMEOUT))}closeError(){this.errorContainer.classList.remove("general-error--open")}}},64:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var a=r(77),s=r.n(a),i=/localhost/gi;var n=new class{constructor(){this.timeOutToken=null,this.isLocalhost=window.location&&window.location.host&&null!==window.location.host.match(i)}request(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"get",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],n={},o="application/x-www-form-urlencoded";return a||(window.clearTimeout(this.timeOutToken),this.timeOutToken=window.setTimeout(()=>{document.body.setAttribute("data-xhr-loading","true")},500)),s.a.interceptors.response.use(e=>(this.beforeResponseHandler(),e),e=>{this.beforeResponseHandler(),console.log("%c %s %s %s ","color: yellow; background-color: black;","--","API error: ".concat(e),"--")}),"post"===t&&(o="application/json"),n["Content-Type"]=o,n["X-Requested-With"]="XMLHttpRequest",i&&!1===this.isLocalhost&&(n["Cache-Control"]="no-cache, no-store, max-age=0"),s()({headers:n,method:t,url:e,data:r,validateStatus:e=>e>=200&&e<=304||400===e})}beforeResponseHandler(){window.clearTimeout(this.timeOutToken),document.body.removeAttribute("data-xhr-loading")}}},66:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var a=r(6),s=r.n(a),i=r(89),n=r.n(i);var o=new class{constructor(){var e=document.body.querySelectorAll("[data-hbs-template]");this.templates={},this.addHelpers(),s()(e,e=>{var t=e.getAttribute("data-hbs-template");this.templates[t]=n.a.compile(e.innerHTML)})}addHelpers(){n.a.registerHelper("ifCond",(function(e,t,r){return e===t?r.fn(this):r.inverse(this)}))}render(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.templates[e]?this.templates[e](t):""}}}}]);
//# sourceMappingURL=search-mobile.bundle.js.map